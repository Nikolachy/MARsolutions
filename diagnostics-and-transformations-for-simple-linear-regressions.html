<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Solutions to A Modern Approach to Regression with R</title>
  <meta name="description" content="This book contains solutions to the problems in the book A Modern Approach to Regression With R, third edition, by Sheather. It is provided as a github repository so that anybody may contribute to its development.">
  <meta name="generator" content="bookdown 0.3.18 and GitBook 2.6.7">

  <meta property="og:title" content="Solutions to A Modern Approach to Regression with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book contains solutions to the problems in the book A Modern Approach to Regression With R, third edition, by Sheather. It is provided as a github repository so that anybody may contribute to its development." />
  <meta name="github-repo" content="jolars/MARsolutions" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Solutions to A Modern Approach to Regression with R" />
  
  <meta name="twitter:description" content="This book contains solutions to the problems in the book A Modern Approach to Regression With R, third edition, by Sheather. It is provided as a github repository so that anybody may contribute to its development." />
  

<meta name="author" content="Johan Larsson">


<meta name="date" content="2017-04-24">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="simple-linear-regression.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dependencies"><i class="fa fa-check"></i>Dependencies</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>2</b> Simple linear regression</a><ul>
<li class="chapter" data-level="2.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#playbill"><i class="fa fa-check"></i><b>2.1</b> playbill</a><ul>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#a"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#b"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#c"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#d"><i class="fa fa-check"></i>d</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#indicators"><i class="fa fa-check"></i><b>2.2</b> Indicators</a><ul>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#a-1"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#b-1"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#invoices"><i class="fa fa-check"></i><b>2.3</b> Invoices</a><ul>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#a-2"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#b-2"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#c-1"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#straight-line-regression-through-the-origin"><i class="fa fa-check"></i><b>2.4</b> Straight-line regression through the origin</a><ul>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#a-3"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#b-3"><i class="fa fa-check"></i>b</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#multiple-choices"><i class="fa fa-check"></i><b>2.5</b> Multiple choices</a></li>
<li class="chapter" data-level="2.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#sst-ssreg-rss"><i class="fa fa-check"></i><b>2.6</b> SST = SSreg + RSS</a><ul>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#a-4"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#b-4"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#c-2"><i class="fa fa-check"></i>c</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#confidence-intervals"><i class="fa fa-check"></i><b>2.7</b> Confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html"><i class="fa fa-check"></i><b>3</b> Diagnostics and transformations for simple linear regressions</a><ul>
<li class="chapter" data-level="3.1" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#airfares"><i class="fa fa-check"></i><b>3.1</b> Airfares</a></li>
<li class="chapter" data-level="3.2" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#true-or-false"><i class="fa fa-check"></i><b>3.2</b> True or false</a></li>
<li class="chapter" data-level="3.3" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#third"><i class="fa fa-check"></i><b>3.3</b> third</a></li>
<li class="chapter" data-level="3.4" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#tryfos-1988"><i class="fa fa-check"></i><b>3.4</b> Tryfos 1988</a><ul>
<li class="chapter" data-level="" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#a-5"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#b-5"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#c-3"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#d-1"><i class="fa fa-check"></i>d</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#cars"><i class="fa fa-check"></i><b>3.5</b> Cars</a><ul>
<li class="chapter" data-level="" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#a-6"><i class="fa fa-check"></i>a</a></li>
<li class="chapter" data-level="" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#b-6"><i class="fa fa-check"></i>b</a></li>
<li class="chapter" data-level="" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#c-4"><i class="fa fa-check"></i>c</a></li>
<li class="chapter" data-level="" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#d-2"><i class="fa fa-check"></i>d</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="diagnostics-and-transformations-for-simple-linear-regressions.html"><a href="diagnostics-and-transformations-for-simple-linear-regressions.html#sixth"><i class="fa fa-check"></i><b>3.6</b> sixth</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Solutions to A Modern Approach to Regression with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="diagnostics-and-transformations-for-simple-linear-regressions" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Diagnostics and transformations for simple linear regressions</h1>
<div id="airfares" class="section level2">
<h2><span class="header-section-number">3.1</span> Airfares</h2>
<p>There is evidence of non-random variance and it looks like a square term might give a better fit. There is also which seems to be a “bad” one – it hold leverage over the model.</p>
<p>However, the patterns of the residuals seem large because of the standardization of the residuals and whilst the non-linear pattern is apparent, modeling for it might not mean a much improved fit depending on how large it is.</p>
<p>The biggest problem with the predictions would occur if we were to predict fares for trips between cities with a larger distances.</p>
</div>
<div id="true-or-false" class="section level2">
<h2><span class="header-section-number">3.2</span> True or false</h2>
<p>Yes, this is a reasonable statement. A rationale is provided below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)
y &lt;-<span class="st"> </span>x +<span class="st"> </span>x ^<span class="st"> </span><span class="dv">2</span> +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">hist</span>(x)
<span class="kw">hist</span>(y)</code></pre></div>
<p><img src="MARsolutions_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))

fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>x)
fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>x +<span class="st"> </span><span class="kw">I</span>(x ^<span class="st"> </span><span class="dv">2</span>))
<span class="kw">anova</span>(fit1, fit2)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: y ~ x
## Model 2: y ~ x + I(x^2)
##   Res.Df RSS Df Sum of Sq   F Pr(&gt;F)    
## 1     98 365                            
## 2     97  90  1       275 298 &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="third" class="section level2">
<h2><span class="header-section-number">3.3</span> third</h2>
<p>Solved previously.</p>
</div>
<div id="tryfos-1988" class="section level2">
<h2><span class="header-section-number">3.4</span> Tryfos 1988</h2>
<div id="a-5" class="section level3 unnumbered">
<h3>a</h3>
<p>No. It seems as if variance is increasing with higher <em>tonnages</em>. There is also evidence of some bimodality and outliers. Moreover, the distribution of the residuals is somewhat non-random.</p>
</div>
<div id="b-5" class="section level3 unnumbered">
<h3>b</h3>
<p>The prediction interval would probably be too short or perhaps even valid. We expect the intervals for the model to be too high for high tonnages and too low for low tonnages.</p>
</div>
<div id="c-3" class="section level3 unnumbered">
<h3>c</h3>
<p>It appears to be something of an improvement. The residuals appear “more” random. Prediction intervals are likely to be more valid for this model because of the more random residuals.</p>
</div>
<div id="d-1" class="section level3 unnumbered">
<h3>d</h3>
<p>The residuals’ variance decreases for higher tonnages. The distribution of the residuals is heavy-tailed.</p>
</div>
</div>
<div id="cars" class="section level2">
<h2><span class="header-section-number">3.5</span> Cars</h2>
<div id="a-6" class="section level3 unnumbered">
<h3>a</h3>
<p>This interpretation is based solely on a general hypothesis test and the coefficient of determination, which might be very misleading and says little about the assumptions of regression.</p>
</div>
<div id="b-6" class="section level3 unnumbered">
<h3>b</h3>
<ul>
<li>There is at least one leverage point which requires further examination, potentially removal.</li>
<li>The residuals are not normally distributed as they are light-tailed. We need to examine this and perhaps transform the data or fit a new model.</li>
<li>The variance shows non-random patterns. It looks almost as if there are three different groups in the data and we might need to look at the data to see if there are any categorical variables that might need to be included to get a better fit.</li>
</ul>
</div>
<div id="c-4" class="section level3 unnumbered">
<h3>c</h3>
<p>The 3.11 model is a slight improvement in that it has</p>
<ul>
<li>better-distributed errors,</li>
<li>less influence given to the outlier, and</li>
<li>not-as-appearant patterns in the residuals.</li>
</ul>
</div>
<div id="d-2" class="section level3 unnumbered">
<h3>d</h3>
</div>
</div>
<div id="sixth" class="section level2">
<h2><span class="header-section-number">3.6</span> sixth</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-linear-regression.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/jolars/MARsolutions/edit/master/03-diagnostics-and-transformations-for-simple-linear-regression.Rmd",
"text": "Edit"
},
"download": ["MARsolutions.pdf", "MARsolutions.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
